#' Compute Exploitation Rate
#'
#' Calculate model-estimated instantaneous exploitation rate with credible
#' intervals over full time-series
#'
#' @param dir_mcmc_out String giving directory containing mcmc outputs
#' @param nyr Total number of years in model time series
#'
#' @returns A list of length 2 containing \link[tibble]{tibble}'s. The first
#' shows model-estimated exploitation rate with credible intervals over the full
#' model time series. The second gives the years in which the fishery was closed
#' (and thus, a known exploitation rate of 0).
#'

compute.exploit.rate <- function(dir_mcmc_out, nyr) {

  year <- exploit <-  NULL

  exploit.rate <- read.exploit.rates(dir_mcmc_out, nyr)

  exploit.rate.df <- tibble::as_tibble(exploit.rate) %>%
    tidyr::pivot_longer(dplyr::everything(), names_to="year", values_to="exploit") %>%
    dplyr::group_by(year) %>%
    ggdist::median_qi(exploit, .width=c(0.95)) %>%
    print(n=10)

  exploit.zeros <- exploit.rate.df[exploit.rate.df$exploit == 0, ]

  return(listN(exploit.rate.df, exploit.zeros))
}
