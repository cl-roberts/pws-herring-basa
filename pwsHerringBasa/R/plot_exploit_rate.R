#' Plot Exploitation Rate
#'
#' Wrapper function for plotting the model-estimated exploitation rate with
#' credible intervals.
#'
#' @param df A data frame (or \link[tibble]{tibble}) returned by
#' \link[pwsHerringBasa]{compute.exploit.rate} containing model-estimated
#' exploitation rate time series with credible intervals
#' @param years Integer vector of years in time series
#'
#' @returns A \link[ggplot2]{ggplot} object showing model-estimated instantaneous
#' exploitation rate over the full model time series, as well as credible intervals
#'


plot_exploit_rate <- function(df, years){
  out <- ggplot(df)+
      geom_errorbar(aes(x=year, ymin=lower_95, ymax=upper_95), width=0) +
      geom_point(aes(x=year, y = exploit), shape = ifelse(df$exploit==0, "cross", NA), size = 3, na.rm = TRUE) +
      geom_point(aes(x=year, y = exploit)) +
      scale_x_continuous("Year", breaks=seq(min(years), max(years), 5), expand=c(.05, .05))+
      scale_y_continuous("Exploitation rate", breaks=seq(0, 0.3, 0.05), expand=c(0, 0))+
      ggtitle("Exploitation rate")+
      coord_cartesian(clip="off")+
      theme_bw(base_size = 12) +
      theme(
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(),
        panel.background = element_blank(),
        axis.line = element_line(colour = "black"),
      )
  return(out)
}
