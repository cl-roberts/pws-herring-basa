#' Plot Exploitation Rate
#'
#' Wrapper function for plotting the model-estimated exploitation rate with
#' credible intervals.
#'
#' @param df A data frame (or \link[tibble]{tibble}) returned by
#' \link[pwsHerringBasa]{compute.exploit.rate} containing model-estimated
#' exploitation rate time series with credible intervals
#' @param zeros A data frame (or \link[tibble]{tibble}) returned by
#' \link[pwsHerringBasa]{compute.exploit.rate} containing years in which the
#' fishery was closed (and thus, a known exploitation rate of 0).
#' @param years Integer vector of years in time series
#'
#' @returns A \link[ggplot2]{ggplot} object showing model-estimated instantaneous
#' exploitation rate over the full model time series, as well as credible intervals
#'


plot_exploit_rate <- function(df, zeros, years){
  out <- ggplot(df, aes(x=.data$year, y=.data$exploit, ymin=.data$.lower, ymax=.data$.upper))+
      ggdist::geom_pointinterval(size=0.25)+
      ggdist::geom_pointinterval(data=zeros, color="black", shape=4)+
      scale_x_discrete("Year", breaks=seq(min(years), max(years), 5), expand=c(0, 0))+
      scale_y_continuous("Exploitation rate", breaks=seq(0, 0.3, 0.05), expand=c(0, 0))+
      ggtitle("Exploitation Rate")+
      coord_cartesian(clip="off")+
      theme(
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(),
        panel.background = element_blank(),
        axis.line = element_line(colour = "black"),
      )
  return(out)
}
